<ng-container *ngIf="!hasNokInput; else errorTemplate">
    <!-- Global Actions -->
    <div class="table-actions" *ngIf="tableConfig?.globalActions">
        <button *ngFor="let action of tableConfig?.globalActions" (click)="executeGlobalAction(action)">
            <i *ngIf="action.icon" class="icon">{{ action.icon }}</i>
            {{ action.label }}
        </button>
    </div>

    <!-- Table -->
    <table class="custom-table" [ngStyle]="tableConfig?.styles">
        <thead>
            <tr>
                <!-- Actions Header -->
                <th *ngIf="tableConfig?.rowActions">Actions</th>
                <!-- Table Headers -->
                <th *ngFor="let col of tableConfig?.columns" [ngStyle]="{ width: col.width }">
                    {{ col.header }}
                    <button *ngIf="col.sortable" (click)="sortColumn(col.field)">
                        Sort
                        <span *ngIf="sortedColumn === col.field">
                            {{ sortDirection === 'asc' ? '↑' : '↓' }}
                        </span>
                    </button>
                </th>
            </tr>
            <tr>
                <!-- Filter Inputs -->
                <!-- Actions Filter (empty for row actions) -->
                <th *ngIf="tableConfig?.rowActions"></th>
                <th *ngFor="let col of tableConfig?.columns">
                    <input *ngIf="col.filterable" type="text" placeholder="Filter..."
                        (input)="onFilterInput(col.field, $event)" />
                </th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let row of filteredData">
                <!-- Row Actions -->
                <td *ngIf="tableConfig?.rowActions">
                    <button *ngFor="let action of tableConfig?.rowActions" (click)="executeRowAction(action, row)">
                        <i *ngIf="action.icon" class="icon">{{ action.icon }}</i>
                        {{ action.label }}
                    </button>
                </td>
                <!-- Row Data -->
                <td *ngFor="let col of tableConfig?.columns">
                    <ng-container *ngIf="col.cellTemplate; else defaultCell">
                        <ng-container
                            *ngTemplateOutlet="col.cellTemplate; context: { $implicit: row[col.field] }"></ng-container>
                    </ng-container>
                    <ng-template #defaultCell>{{ row[col.field] }}</ng-template>
                </td>
            </tr>
        </tbody>
    </table>
</ng-container>

<!-- Error Template -->
<ng-template #errorTemplate>
    <div class="no-input-message">
        <p>Table configuration or data is invalid. Please check your inputs.</p>
    </div>
</ng-template>